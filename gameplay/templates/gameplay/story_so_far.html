{% extends "base.html" %}

{% block title %}PÅ™Ã­bÄ›h zatÃ­m{% endblock %}

{% block content %}
<style>
body {
  overflow-y: auto;
}
</style>


<!-- Main container for the story section -->
<div class="section-wrapper" style="text-align: center;">
<h1>Story So Far</h1>
  <h2>PÅ™ehraj spomÃ­nky:</h2>
  <!-- Buttons to play different sequences based on progress -->
  <div class="sequence-buttons" style="justify-content: center;">
    <button onclick="playSequence('intro')">ğŸ” PÅ™ehrÃ¡t Intro</button>

    {% if unlocked_easy|length == 20 and total_unlocked < 60 %}
      <button onclick="playSequence('easy_end')">ğŸ”“ Konec Easy</button>
    {% endif %}

    {% if unlocked_easy|length == 20 and unlocked_medium|length == 20 and total_unlocked < 60 %}
      <button onclick="playSequence('medium_end')">ğŸ”“ Konec Medium</button>
    {% endif %}

    {% if total_unlocked == 60 %}
      <button onclick="playSequence('hard_end')">ğŸ Konec Hard</button>
    {% endif %}
  </div>
</div>

<!-- Display buttons for continuing the game or resetting progress -->
{% if total_unlocked < 60 %}
<div class="play-again-container">
    <h3>TajemstvÃ­ si jeÅ¡tÄ› neodhalil</h3>
    <a href="{% url 'game_selection' %}" class="play-again">PokraÄuj</a>
</div>
{% else %}
<!-- If all memories are unlocked, show credits -->
<div class="play-again-container">
    <h3>Hru vytvoÅ™il:</h3>
    <button class="play-again" onclick="showCreditsModal()">Credits</button>
</div>

<!-- Modal for displaying credits -->
<div id="credits-box" class="credits-box hidden">
    <h4>ğŸ¬ VÃ½voj MystDoku</h4>
    <ul>
        <li><strong>Design & KÃ³d:</strong> Mitelin</li>
        <li><strong>PÅ™Ã­bÄ›h:</strong> AI + Mitelin</li>
        <li><strong>Hudba:</strong> Generated / CC0</li>
        <li><strong>Styl & UX:</strong> SpoleÄnÃ½ vÃ½voj ğŸ§ </li>
        <li><strong>SpeciÃ¡lnÃ­ dÃ­ky:</strong> TobÄ›, Å¾e hrajeÅ¡ â¤ï¸</li>
    </ul>
</div>
{% endif %}
<!-- Container for displaying unlocked memories -->
<div class="story-container">
  <h2 class="story-title">ğŸŒ¸ TvÅ¯j pÅ™Ã­bÄ›h</h2>
  <!-- Display unlocked easy memories -->
  {% if unlocked_easy %}
    <h3 class="story-act">ğŸŸ¢ Expozice</h3>
    <div class="story-content">
      {% for mem in unlocked_easy %}
        <p>{{ mem.text }}</p>
      {% endfor %}
    </div>
  {% endif %}
<!-- Display unlocked medium memories -->
  {% if unlocked_medium %}
    <h3 class="story-act">ğŸŸ  Kolize</h3>
    <div class="story-content">
      {% for mem in unlocked_medium %}
        <p>{{ mem.text }}</p>
      {% endfor %}
    </div>
  {% endif %}
  <!-- Display unlocked hard memories -->
  {% if unlocked_hard %}
    <h3 class="story-act">ğŸ”´ Krize a rozuzlenÃ­</h3>
    <div class="story-content">
      {% for mem in unlocked_hard %}
        <p>{{ mem.text }}</p>
      {% endfor %}
    </div>
  {% endif %}
</div>
    <!-- !!!DEBUG SECTION!!! -->
{% comment %}
<!-- Debug buttons to trigger different story sequences -->
<div class="sequence-buttons">
  <button onclick="playSequence('intro')">PÅ™ehrÃ¡t Intro</button>
  <button onclick="playSequence('easy_end')">PÅ™ehrÃ¡t Konec Easy</button>
  <button onclick="playSequence('medium_end')">PÅ™ehrÃ¡t Konec Medium</button>
  <button onclick="playSequence('hard_end')">PÅ™ehrÃ¡t Konec Hard</button>
<!-- Debug section displaying the raw sequence data -->
</div>
<h3>Debug: Intro data</h3>
<ul>
  {% for line in sequences.intro %}
    <li>{{ line }}</li>
  {% empty %}
    <li><strong>Å½Ã¡dnÃ¡ data v sequences["intro"]</strong></li>
  {% endfor %}
</ul>
<ul>
  {% for line in sequences.easy_end %}
    <li>{{ line }}</li>
  {% empty %}
    <li><strong>Å½Ã¡dnÃ¡ data v sequences["easy_end"]</strong></li>
  {% endfor %}
</ul>
<ul>
  {% for line in sequences.medium_end %}
    <li>{{ line }}</li>
  {% empty %}
    <li><strong>Å½Ã¡dnÃ¡ data v sequences["medium_end"]</strong></li>
  {% endfor %}
</ul>
<ul>
  {% for line in sequences.hard_end %}
    <li>{{ line }}</li>
  {% empty %}
    <li><strong>Å½Ã¡dnÃ¡ data v sequences["hard_end"]</strong></li>
  {% endfor %}
</ul>

<hr>
<h3 style="color: crimson;">ğŸ›  Debug: Memory vÃ½pis podle obtÃ­Å¾nosti</h3>
<!-- Debug: Displaying unlocked memories for each difficulty -->
<h4>ğŸŸ¢ Easy ({{ unlocked_easy|length }}/20)</h4>
<ul>
  {% for mem in unlocked_easy %}
    <li>#{{ mem.order }} â€“ {{ mem.text|truncatechars:80 }}</li>
  {% empty %}
    <li><i>Å½Ã¡dnÃ© odemÄenÃ© vzpomÃ­nky</i></li>
  {% endfor %}
</ul>

<h4>ğŸŸ  Medium ({{ unlocked_medium|length }}/20)</h4>
<ul>
  {% for mem in unlocked_medium %}
    <li>#{{ mem.order }} â€“ {{ mem.text|truncatechars:80 }}</li>
  {% empty %}
    <li><i>Å½Ã¡dnÃ© odemÄenÃ© vzpomÃ­nky</i></li>
  {% endfor %}
</ul>

<h4>ğŸ”´ Hard ({{ unlocked_hard|length }}/20)</h4>
<ul>
  {% for mem in unlocked_hard %}
    <li>#{{ mem.order }} â€“ {{ mem.text|truncatechars:80 }}</li>
  {% empty %}
    <li><i>Å½Ã¡dnÃ© odemÄenÃ© vzpomÃ­nky</i></li>
  {% endfor %}
</ul>
<h3>ğŸ›  Debug: PÅ™idat vzpomÃ­nku</h3>
<a href="{% url 'debug_add_memory' 'easy' %}" class="debug-button">â• Easy Memory</a>
<a href="{% url 'debug_add_memory' 'medium' %}" class="debug-button">â• Medium Memory</a>
<a href="{% url 'debug_add_memory' 'hard' %}" class="debug-button">â• Hard Memory</a>
<br>
<a href="{% url 'reset_progress' %}" class="debug-button" style="background: darkred;">ğŸ” Resetuj vÅ¡echny vzpomÃ­nky</a>
    {% endcomment %}
    <!-- !!! END OF DEBUG SECTION!!! -->
    <!-- Modal for credits -->
<div id="credits-modal" class="modal-overlay hidden">
  <div class="modal-box">
    <h3>ğŸ¬ VÃ½voj MystDoku</h3>
    <ul>
      <li><strong>Design & KÃ³d:</strong> Michal PeÅ¡ta</li>
      <li><strong>PÅ™Ã­bÄ›h:</strong> AI + Michal PeÅ¡ta</li>
      <li><strong>Hudba:</strong> Generated / CC0</li>
      <li><strong>Styl & UX:</strong> AI + Michal PeÅ¡ta</li>
      <li><strong>SpeciÃ¡lnÃ­ dÃ­ky:</strong> TobÄ›, Å¾e hrajeÅ¡ </li>
    </ul>
    <button onclick="hideCreditsModal()" class="modal-close">ZavÅ™Ã­t</button>
  </div>
</div>
{% include "partials/sequence.html" with name=sequence_name frames=sequence_frames images=sequence_images %}
{% endblock %}
